<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Biolux Agency Stats Form</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    label { font-weight: bold; margin-top: 12px; display: block; }
    input, select { width: 100%; padding: 8px; margin-top: 5px; }
    button { margin-top: 20px; padding: 10px 20px; font-size: 16px; }
    #output { background: #f4f4f4; padding: 10px; margin-top: 20px; white-space: pre; }
  </style>
</head>
<body>
  <h1>Agency Product Statistics</h1>

  <!-- Agency Info -->
  <label>Shop Name</label>
  <select id="shopName"></select>

  <label>Wilaya</label>
  <select id="wilaya"></select>

  <label>Owner Name</label>
  <input id="owner" type="text" />

  <h3>Products</h3>
  <label>Select Product</label>
  <select id="productSelect"></select>

  <label>Quantity</label>
  <input id="quantity" type="number" />

  <button onclick="addProduct()">Add Product</button>
  <button onclick="saveForm()">Save</button>

  <h3>Stored Data</h3>
  <div id="output"></div>

<script>
  // JSON DATABASE
  const db = {
    wilayas: ["Algiers", "Oran", "Constantine", "Bejaia", "Tlemcen", "Setif", "Blida"],
    shops: ["TechStore", "ElectroPlus", "MegaHome", "HouseLine"],
    products: [
      { brand: "Beko", model: "Beko Fridge 340L", price: 82000 },
      { brand: "Beko", model: "Beko TV 55'' Smart", price: 110000 },
      { brand: "Beko", model: "Beko Washing Machine 8kg", price: 90000 },

      { brand: "Maxwell House", model: "Maxwell Coffee Maker X1", price: 5000 },
      { brand: "Maxwell House", model: "Maxwell Blender 700W", price: 6200 }
    ]
  };

  // Insert data into dropdowns
  const productSelect = document.getElementById("productSelect");
  const wilayaSelect = document.getElementById("wilaya");
  const shopSelect = document.getElementById("shopName");

  db.products.forEach(p => {
    const opt = document.createElement("option");
    opt.value = p.model;
    opt.textContent = `${p.brand} â€“ ${p.model} (${p.price} DA)`;
    productSelect.appendChild(opt);
  });

  db.wilayas.forEach(w => {
    const opt = document.createElement("option");
    opt.value = w;
    opt.textContent = w;
    wilayaSelect.appendChild(opt);
  });

  db.shops.forEach(s => {
    const opt = document.createElement("option");
    opt.value = s;
    opt.textContent = s;
    shopSelect.appendChild(opt);
  });

  let selectedProducts = [];

  function addProduct() {
    const model = document.getElementById("productSelect").value;
    const qty = parseInt(document.getElementById("quantity").value);
    if (!qty || qty <= 0) return;

    const product = db.products.find(p => p.model === model);

    selectedProducts.push({ model: product.model, brand: product.brand, qty, price: product.price });
    display();
  }

  function calculateNetWorth() {
    return selectedProducts.reduce((sum, item) => sum + item.qty * item.price, 0);
  }

  let savedForms = JSON.parse(localStorage.getItem("agencyData")) || [];

  function saveForm() {
    const entry = {
      shop: document.getElementById("shopName").value,
      wilaya: document.getElementById("wilaya").value,
      owner: document.getElementById("owner").value,
      products: selectedProducts,
      totalNetWorth: calculateNetWorth(),
      timestamp: new Date().toISOString()
    };

    savedForms.push(entry);
    localStorage.setItem("agencyData", JSON.stringify(savedForms));
    display();
  }

  function display() {
    document.getElementById("output").textContent = JSON.stringify({selectedProducts, savedForms}, null, 2);
  }

  display();
</script>
</body>
</html>
